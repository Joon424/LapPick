<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="imagetoolbar" content="no">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="format-detection" content="telephone=no">
  <meta name="title" content="웹사이트">
  <meta name="description" content="웹사이트입니다.">
  <meta name="keywords" content="키워드,키워드,키워드">
  <meta property="og:title" content="웹사이트">
  <meta property="og:description" content="웹사이트입니다">
  <meta property="og:image" content="https://웹사이트/images/opengraph.png">
  <meta property="og:url" content="https://웹사이트">
  <title>회원_마이페이지 | Miso</title>
  <script src="/static/js/cartButton.js"></script>
  <link rel="stylesheet"  href="/resources/css/setting.css">
  <link rel="stylesheet"  href="/resources/css/plugin.css">
  <link rel="stylesheet"  href="/resources/css/template.css">
  <link rel="stylesheet"  href="/resources/css/common.css">
  <link rel="stylesheet"  href="/resources/css/style.css">
<script>
  function showInfo() {
    document.getElementById("infoSection").style.display = "block";
    document.getElementById("editSection").style.display = "none";
    document.getElementById("passwordSection").style.display = "none";
  }

  function editInfo() {
    document.getElementById("infoSection").style.display = "none";
    document.getElementById("editSection").style.display = "block";
    document.getElementById("passwordSection").style.display = "none";
  }

  function changePassword() {
    document.getElementById("infoSection").style.display = "none";
    document.getElementById("editSection").style.display = "none";
    document.getElementById("passwordSection").style.display = "block";
  }

  function confirmDelete() {
	    if (!confirm("정말 탈퇴하시겠습니까?")) return;
	    var pw = prompt("비밀번호를 입력하세요");
	    if (!pw || pw.trim().length === 0) return;

	    var f = document.createElement('form');
	    f.method = 'post';
	    f.action = '/memberDropOk';

	    var i = document.createElement('input');
	    i.type = 'hidden';
	    i.name = 'memberPw';
	    i.value = pw.trim();
	    f.appendChild(i);

	    // CSRF(있으면만 추가)
	    var p = document.getElementById('csrfParam');
	    var t = document.getElementById('csrfToken');
	    if (p && t) {
	      var c = document.createElement('input');
	      c.type = 'hidden';
	      c.name = p.value;
	      c.value = t.value;
	      f.appendChild(c);
	    }
	    document.body.appendChild(f);
	    f.submit();
	  }
	  }
  
  function navigateTo(path){ location.href = (path === '/cart') ? '/item/cartList' : path; }
</script>

<script th:if="${message}" th:inline="javascript">
  alert(/*[[${#strings.escapeJavaScript(message)}]]*/'');
</script>
</head>

<body>
  <!-- [S]basic-N3 -->
  <div class="basic-N3" data-bid="KrM47tVDk5" id="">
    <div class="header-inner">
      <div class="header-container container-lg">
        <div class="header-left">
          <h1 class="header-title">
            <a href="/">
              <img  src="/resources/images/img_logo_black.png" alt="로고">
            </a>
          </h1>
          <div class="header-mobile-group">
            <div class="header-mobile-top">
              <p>로그인이 필요합니다.</p>
              <a href="javascript:void(0)">로그인</a>
            </div>
                        <ul class="header-gnblist">
              <li class="header-gnbitem">
                <a class="header-gnblink" href="/banner/brand">
                  <span>BRAND</span>
                </a>
              </li>
              <li class="header-gnbitem">
                <a class="header-gnblink" href="/goods/goodsFullList">
                  <span>PRODUCTS</span>
                </a>
              </li>
              <li class="header-gnbitem">
                <a class="header-gnblink" href="/banner/notice">
                  <span>NOTICE</span>
                </a>
              </li>
              <li class="header-gnbitem">
                <a class="header-gnblink" href="/banner/faq">
                  <span>FAQ</span>
                </a>
              </li>
          <li class="header-gnbitem">
  <a class="header-gnblink" 
     th:href="${isLoggedIn} ? '/login/logout' : '/login/item.login'">
    <span th:text="${isLoggedIn} ? 'LOGOUT' : 'LOGIN'"
          th:style="${isLoggedIn} ? 'color: red;' : ''">LOGIN</span>
  </a>
</li>

            </ul>
            <button class="header-btn btn-close">
              <img  src="/resources/icons/ico_close_white.svg" alt="닫기 아이콘">
            </button>
          </div>
        </div>
        <div class="header-right">
          <div class="header-utils">
            <button class="header-btn btn-seach">
              <img  src="/resources/icons/ico_seach_black.svg" alt="검색 아이콘">
            </button>
            <a href="/login/userIcon" class="header-btn btn-user" id="user-icon">
              <img  src="/resources/icons/ico_user_black.svg" alt="유저 아이콘">
            </a>
            <button class="header-btn btn-cart badgeset badgeset-circle badgeset-position badgeset-bottom-right">
              <img  src="/resources/icons/ico_cart_black.svg" alt="쇼핑백 아이콘">
              <span class="badgeset-text">1</span>
            </button>
            <button class="header-btn btn-allmenu">
              <img  src="/resources/icons/ico_menu2_black.svg" alt="PC메뉴 아이콘">
            </button>
            <button class="header-btn btn-momenu">
              <img  src="/resources/icons/ico_menu2_black.svg" alt="모바일메뉴 아이콘">
            </button>
            <button class="header-btn btn-close">
              <img  src="/resources/icons/ico_close_black.svg" alt="닫기 아이콘">
            </button>
          </div>
        </div>
      </div>
    </div>
    <div class="header-dim"></div>
  </div>
  <!-- [E]basic-N3 -->
  <main class="th-layout-main ">
       <!-- [S]basic-N32 -->
    <div class="basic-N32" data-bid="Igm47u9U8o" id="">
      <div class="contents-inner">
        <div class="contents-container container-md">
          <div class="imageset">
            <img class="imageset-img"  src="/resources/images/img_basic_N32_1.png" alt="이미지">
          </div>
     <div class="textset">
      <h2 class="textset-tit">회원 마이페이지</h2>
      <p class="textset-desc">-----------------------------------------------------------------------------------------</p>
      <a href="javascript:navigateTo('/orderHistory');" class="btnset btnset-line btnset-round">주문 내역</a>
      <a href="javascript:navigateTo('/cart');" class="btnset btnset-line btnset-round" >장바구니</a>
      <p class="textset-desc">-----------------------------------------------------------------------------------------</p>
      <a href="javascript:showInfo();" class="btnset btnset-line btnset-round">내 정보 보기</a>
      <a href="javascript:editInfo();" class="btnset btnset-line btnset-round">내 정보 수정</a>
      <p class="textset-desc">-----------------------------------------------------------------------------------------</p>
      <a href="javascript:changePassword();" class="btnset btnset-line btnset-round">비밀번호 변경</a>
      <a href="javascript:confirmDelete();" class="btnset btnset-line btnset-round" style="background-color: rgb(220, 220, 220);">회원 탈퇴</a>
    </div>
        </div>
 <!-- 내 정보 영역 -->
  <div id="infoSection" style="display:none; margin-top:20px;">
    <h3>내 정보</h3>
    <p>이름: [[${memberCommand.memberName}]]</p>
    <p>아이디: [[${memberCommand.memberId}]]</p>
    <p>주소: [[${memberCommand.memberAddr}]]</p>
    <p>상세주소: [[${memberCommand.memberAddrDetail}]]</p>
    <p>우편번호: [[${memberCommand.memberPost}]]</p>
    <p>연락처1: [[${memberCommand.memberPhone1}]]</p>
    <p>연락처2: [[${memberCommand.memberPhone2}]]</p>
    <p>성별: [[${memberCommand.gender}]]</p>
    <p>등록일: [[${#dates.format(memberCommand.memberRegist, 'yyyy-MM-dd')}]]</p>
    <p>생년월일: [[${#dates.format(memberCommand.memberBirth, 'yyyy-MM-dd')}]]</p>
    <p>이메일: [[${memberCommand.memberEmail}]]</p>
  </div>

  <!-- 수정 영역 -->
  <div id="editSection" style="display:none; margin-top:20px;">
    <form th:action="@{/memberUpdate}" method="post">
      <h3>내 정보 수정</h3>
      <label>이름: <input type="text" name="memberName" th:value="${memberCommand.memberName}"></label><br>
        <label>아이디: <input type="text" name="memberId" th:value="${memberCommand.memberId}" readonly></label><br>
        <label>주소: <input type="text" name="memberAddr" th:value="${memberCommand.memberAddr}"></label><br>
        <label>상세주소: <input type="text" name="memberAddrDetail" th:value="${memberCommand.memberAddrDetail}"></label><br>
        <label>우편번호: <input type="text" name="memberPost" th:value="${memberCommand.memberPost}"></label><br>
        <label>연락처1: <input type="text" name="memberPhone1" th:value="${memberCommand.memberPhone1}"></label><br>
        <label>이메일: <input type="email" name="memberEmail" th:value="${memberCommand.memberEmail}"></label><br>
        
        <label>비밀번호 확인</label>
  		<input type="password" name="memberPw" placeholder="현재 비밀번호">

  		<!-- (선택) 누락 방지용 숨은 필드들 -->
  		<input type="hidden" name="memberPhone2" value="" />
  		<input type="hidden" name="memberBirth"  value="" />
  		
      <button type="submit">수정</button>
    </form>
  </div>

  <!-- 비밀번호 변경 영역 -->
  <div id="passwordSection" style="display:none; margin-top:20px;">
    <form method="post" action="/memberPwModify">
      <h3>비밀번호 변경</h3>
      <label>현재 비밀번호: <input type="password" name="oldPw"></label><br>
      <label>새 비밀번호: <input type="password" name="newPw"></label><br>
      <button type="submit">비밀번호 변경</button>
    </form>
  </div>
</div>
    <!-- [E]basic-N32 -->
  </main>
  <!-- [S]basic-N4 -->
  <div class="basic-N4" data-bid="OXm47tvnu9">
    <div class="footer-inner">
      <div class="footer-container container-lg">
        <div class="footer-top">
          <h1 class="footer-logo">
            <a href="javascript:void(0)">
              <img  src="/resources/images/img_logo_lightgray.png" alt="로고">
            </a>
          </h1>
     <ul class="footer-menulist">
            <li class="footer-menuitem">
              <a href="javascript:void(0)">
                <span>이용약관</span>
              </a>
            </li>
            <li class="footer-menuitem">
              <a href="javascript:void(0)">
                <span>개인정보처리방침</span>
              </a>
            </li>
            <li class="footer-menuitem">
              <a href="javascript:void(0)">
                <span>국비교육</span>
              </a>
            </li>
            <li class="footer-menuitem">
              <a href="javascript:void(0)">
                <span>미니프로젝트</span>
              </a>
            </li>
          </ul>
          <ul class="footer-snslist">
            <li class="footer-snsitem">
              <a class="footer-snslink" href="javascript:void(0)">
                <img  src="/resources/icons/ico_instagram_lightgrey.svg" alt="인스타그램">
              </a>
            </li>
            <li class="footer-snsitem">
              <a class="footer-snslink" href="javascript:void(0)">
                <img  src="/resources/icons/ico_youtube_lightgrey.svg" alt="유튜브">
              </a>
            </li>
            <li class="footer-snsitem">
              <a class="footer-snslink" href="javascript:void(0)">
                <img  src="/resources/icons/ico_facebook_lightgrey.svg" alt="페이스북">
              </a>
            </li>
            <li class="footer-snsitem">
              <a class="footer-snslink" href="javascript:void(0)">
                <img  src="/resources/icons/ico_kakao_lightgrey.svg" alt="카카오톡">
              </a>
            </li>
          </ul>
        </div>
         <div class="footer-bottom">
          <div class="footer-txt">
            <p> 성결대학교 성결관 301호 </p>
            <p>
              <span>T. 010-8246-6830</span>
              <span>E. wnflqm010203@sungkyul.ac.kr</span>
            </p>
          </div>
          <div class="footer-txt">
            <p>2024 BY JeongJunGyo. ALL RIGHTS RESEVED</p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- [E]basic-N4 -->
  <script  src="/resources/js/setting.js"></script>
  <script  src="/resources/js/plugin.js"></script>
  <script  src="/resources/js/template.js"></script>
  <script  src="/resources/js/common.js"></script>
  <script  src="/resources/js/script.js"></script>

<span id="flash-msg" th:if="${flashMsg}" th:text="${flashMsg}" style="display:none"></span>
<script>
  (function(){
    var el = document.getElementById('flash-msg');
    if (el) { alert(el.textContent); el.remove(); }
  })();
</script>
</body>
